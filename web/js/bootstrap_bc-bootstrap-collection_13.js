!function(e){"use strict";var t='[data-addfield="collection"]',i='[data-removefield="collection"]',d=function(i){e(i).on("click",t,this.addField)},o=function(t){e(t).on("click",i,this.removeField)};d.prototype.addField=function(t){var i=e(this),d=i.attr("data-collection"),o=i.attr("data-prototype-name");t&&t.preventDefault();for(var n=e("#"+d),a=n.find("> ul"),l=a.find("> li").size(),r=n.attr("data-prototype"),c=r.match(/id="(.*?)"/),f=new RegExp(o,"g");e("#"+c[1].replace(f,l)).size()>0;)l++;r=r.replace(f,l),r=r.replace(/__id__/g,c[1].replace(f,l));var p=e("<li></li>").html(r);p.appendTo(a),i.trigger("bc-collection-field-added")},o.prototype.removeField=function(t){var i=e(this);i.attr("data-field");t&&t.preventDefault(),i.trigger("bc-collection-field-removed");i.closest("li").remove()};var n=e.fn.addField,a=e.fn.removeField;e.fn.addField=function(t){return this.each(function(){var i=e(this),o=i.data("addfield");o||i.data("addfield",o=new d(this)),"string"==typeof t&&o[t].call(i)})},e.fn.removeField=function(t){return this.each(function(){var i=e(this),d=i.data("removefield");d||i.data("removefield",d=new o(this)),"string"==typeof t&&d[t].call(i)})},e.fn.addField.Constructor=d,e.fn.removeField.Constructor=o,e.fn.addField.noConflict=function(){return e.fn.addField=n,this},e.fn.removeField.noConflict=function(){return e.fn.removeField=a,this},e(document).on("click.addfield.data-api",t,d.prototype.addField),e(document).on("click.removefield.data-api",i,o.prototype.removeField)}(window.jQuery);